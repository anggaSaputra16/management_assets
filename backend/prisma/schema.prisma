generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model asset_attachments {
  id             String    @id @default(cuid())
  fileName       String
  originalName   String
  filePath       String
  fileSize       Int?
  mimeType       String?
  attachmentType String
  description    String?
  isActive       Boolean   @default(true)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime @updatedAt
  assetId        String
  companyId      String
  uploadedById   String
  assets         Asset    @relation(fields: [assetId], references: [id])
  companies      Company @relation(fields: [companyId], references: [id])
  users          User     @relation(fields: [uploadedById], references: [id])
}

model asset_components {
  id                                            String                          @id @default(cuid())
  name                                          String
  description                                   String?
  partNumber                                    String?
  serialNumber                                  String?
  brand                                         String?
  model                                         String?
  status                                        String
  purchaseDate                                  DateTime?
  purchasePrice                                 Decimal?                        @db.Decimal(10, 2)
  warrantyExpiry                                DateTime?
  isReplaceable                                 Boolean                         @default(true)
  isTransferable                                Boolean                         @default(true)
  notes                                         String?
  specifications                                Json?
  assetId                                       String
  parentAssetId                                 String?
  sourcePartId                                  String?
  createdAt                                     DateTime                        @default(now())
  updatedAt                                     DateTime @updatedAt
  assets_asset_components_assetIdToassets       Asset                          @relation("asset_components_assetIdToassets", fields: [assetId], references: [id])
  assets_asset_components_parentAssetIdToassets Asset?                         @relation("asset_components_parentAssetIdToassets", fields: [parentAssetId], references: [id])
  spare_parts                                   SparePart?                    @relation(fields: [sourcePartId], references: [id])
  component_maintenance_records                 component_maintenance_records[]
  component_transfers                           component_transfers[]
  part_replacements                             part_replacements[]
  part_usages                                   part_usages[]
}

model asset_depreciations {
  id                      String                 @id @default(cuid())
  depreciationMethod      String                 @default("STRAIGHT_LINE")
  usefulLife              Int
  salvageValue            Decimal?               @db.Decimal(15, 2)
  depreciationRate        Decimal?               @db.Decimal(5, 4)
  currentBookValue        Decimal?               @db.Decimal(15, 2)
  accumulatedDepreciation Decimal?               @db.Decimal(15, 2)
  lastCalculatedDate      DateTime?
  isActive                Boolean                @default(true)
  notes                   String?
  assetId                 String                 @unique
  createdAt               DateTime               @default(now())
  updatedAt               DateTime @updatedAt
  assets                  Asset                 @relation(fields: [assetId], references: [id])
  depreciation_records    depreciation_records[]
}

model AssetRequest {
  id                                       String                @id @default(cuid())
  requestNumber                            String                @unique
  description                              String
  justification                            String
  priority                                 String                @default("MEDIUM")
  status                                   String
  requestedDate                            DateTime              @default(now())
  approvedDate                             DateTime?
  allocatedDate                            DateTime?
  rejectionReason                          String?
  notes                                    String?
  requesterId                              String
  departmentId                             String
  assetId                                  String?
  approvedById                             String?
  createdAt                                DateTime              @default(now())
  updatedAt                                DateTime @updatedAt
  actualCost                               Decimal?              @db.Decimal(15, 2)
  companyId                                String
  completedDate                            DateTime?
  estimatedCost                            Decimal?              @db.Decimal(15, 2)
  requestType                              String
  requiredDate                             DateTime?
  title                                    String
  editedBy                                 String?
  lastEditedAt                             DateTime?
  needMaintenance                          Boolean?              @default(false)
  needDecomposition                        Boolean?              @default(false)
  users_asset_requests_approvedByIdTousers User?                @relation("asset_requests_approvedByIdTousers", fields: [approvedById], references: [id])
  asset                                    Asset?               @relation(fields: [assetId], references: [id])
  company                                  Company              @relation(fields: [companyId], references: [id])
  department                               Department           @relation(fields: [departmentId], references: [id])
  users_asset_requests_editedByTousers     User?                @relation("asset_requests_editedByTousers", fields: [editedBy], references: [id])
  requester                                User                 @relation("asset_requests_requesterIdTousers", fields: [requesterId], references: [id])
  maintenance_records                      MaintenanceRecord[]
  request_attachments                      request_attachments[]
  request_workflows                        request_workflows[]

  @@map("asset_requests")
}

model asset_required_software {
  id              String          @id @default(cuid())
  isRequired      Boolean         @default(true)
  notes           String?
  createdAt       DateTime        @default(now())
  updatedAt       DateTime @updatedAt
  assetId         String
  softwareAssetId String
  companyId       String
  assets          Asset          @relation(fields: [assetId], references: [id])
  companies       Company       @relation(fields: [companyId], references: [id])
  software_assets SoftwareAsset @relation(fields: [softwareAssetId], references: [id])

  @@unique([assetId, softwareAssetId])
}

model asset_transfers {
  id                                                        String       @id @default(cuid())
  transferNumber                                            String       @unique
  reason                                                    String
  transferDate                                              DateTime     @default(now())
  effectiveDate                                             DateTime?
  notes                                                     String?
  approvalNotes                                             String?
  status                                                    String       @default("PENDING")
  assetId                                                   String
  fromLocationId                                            String?
  toLocationId                                              String?
  fromDepartmentId                                          String?
  toDepartmentId                                            String?
  requestedById                                             String
  approvedById                                              String?
  createdAt                                                 DateTime     @default(now())
  updatedAt                                                 DateTime @updatedAt
  fromEmployeeId                                            String?
  toEmployeeId                                              String?
  editedBy                                                  String?
  lastEditedAt                                              DateTime?
  users_asset_transfers_approvedByIdTousers                 User?       @relation("asset_transfers_approvedByIdTousers", fields: [approvedById], references: [id])
  assets                                                    Asset       @relation(fields: [assetId], references: [id])
  users_asset_transfers_editedByTousers                     User?       @relation("asset_transfers_editedByTousers", fields: [editedBy], references: [id])
  departments_asset_transfers_fromDepartmentIdTodepartments Department? @relation("asset_transfers_fromDepartmentIdTodepartments", fields: [fromDepartmentId], references: [id])
  employees_asset_transfers_fromEmployeeIdToemployees       Employee?   @relation("asset_transfers_fromEmployeeIdToemployees", fields: [fromEmployeeId], references: [id])
  locations_asset_transfers_fromLocationIdTolocations       Location?   @relation("asset_transfers_fromLocationIdTolocations", fields: [fromLocationId], references: [id])
  users_asset_transfers_requestedByIdTousers                User        @relation("asset_transfers_requestedByIdTousers", fields: [requestedById], references: [id])
  departments_asset_transfers_toDepartmentIdTodepartments   Department? @relation("asset_transfers_toDepartmentIdTodepartments", fields: [toDepartmentId], references: [id])
  employees_asset_transfers_toEmployeeIdToemployees         Employee?   @relation("asset_transfers_toEmployeeIdToemployees", fields: [toEmployeeId], references: [id])
  locations_asset_transfers_toLocationIdTolocations         Location?   @relation("asset_transfers_toLocationIdTolocations", fields: [toLocationId], references: [id])
}

model Asset {
  id                                                          String                    @id @default(cuid())
  assetTag                                                    String                    @unique
  name                                                        String
  description                                                 String?
  serialNumber                                                String?
  model                                                       String?
  brand                                                       String?
  purchaseDate                                                DateTime?
  purchasePrice                                               Decimal?                  @db.Decimal(15, 2)
  currentValue                                                Decimal?                  @db.Decimal(15, 2)
  warrantyExpiry                                              DateTime?
  status                                                      String
  condition                                                   String?
  notes                                                       String?
  isActive                                                    Boolean                   @default(true)
  createdAt                                                   DateTime                  @default(now())
  updatedAt                                                   DateTime @updatedAt
  categoryId                                                  String
  vendorId                                                    String?
  locationId                                                  String?
  departmentId                                                String?
  poNumber                                                    String?
  qrCode                                                      String?
  imageUrl                                                    String?
  specifications                                              Json?
  companyId                                                   String
  assignedEmployeeId                                          String?
  editedBy                                                    String?
  lastEditedAt                                                DateTime?
  asset_attachments                                           asset_attachments[]
  asset_components_asset_components_assetIdToassets           asset_components[]        @relation("asset_components_assetIdToassets")
  asset_components_asset_components_parentAssetIdToassets     asset_components[]        @relation("asset_components_parentAssetIdToassets")
  asset_depreciations                                         asset_depreciations?
  asset_requests                                              AssetRequest[]
  asset_required_software                                     asset_required_software[]
  asset_transfers                                             asset_transfers[]
  employees                                                   Employee?                @relation(fields: [assignedEmployeeId], references: [id])
  categories                                                  Category                @relation(fields: [categoryId], references: [id])
  companies                                                   Company                 @relation(fields: [companyId], references: [id])
  departments                                                 Department?              @relation(fields: [departmentId], references: [id])
  users                                                       User?                    @relation(fields: [editedBy], references: [id])
  locations                                                   Location?                @relation(fields: [locationId], references: [id])
  vendors                                                     Vendor?                  @relation(fields: [vendorId], references: [id])
  audit_records                                               audit_records[]
  component_transfers_component_transfers_fromAssetIdToassets component_transfers[]     @relation("component_transfers_fromAssetIdToassets")
  component_transfers_component_transfers_toAssetIdToassets   component_transfers[]     @relation("component_transfers_toAssetIdToassets")
  disposal_records                                            disposal_records?
  inventories                                                 inventories[]
  maintenance_records                                         MaintenanceRecord[]
  new_part_registrations                                      new_part_registrations[]
  part_replacements                                           part_replacements[]
  part_usages                                                 part_usages[]
  software_installations                                      software_installations[]

  @@map("assets")
}

model audit_records {
  id                                   String    @id @default(cuid())
  auditType                            String
  scheduledDate                        DateTime
  completedDate                        DateTime?
  status                               String
  findings                             String?
  recommendations                      String?
  assetId                              String?
  auditorId                            String
  createdAt                            DateTime  @default(now())
  updatedAt                            DateTime @updatedAt
  editedBy                             String?
  lastEditedAt                         DateTime?
  assets                               Asset?   @relation(fields: [assetId], references: [id])
  users_audit_records_auditorIdTousers User     @relation("audit_records_auditorIdTousers", fields: [auditorId], references: [id])
  users_audit_records_editedByTousers  User?    @relation("audit_records_editedByTousers", fields: [editedBy], references: [id])
}

model audit_trails {
  id          String    @id @default(cuid())
  action      String
  entityType  String
  entityId    String
  oldValues   Json?
  newValues   Json?
  description String?
  ipAddress   String?
  userAgent   String?
  sessionId   String?
  userId      String
  companyId   String
  createdAt   DateTime  @default(now())
  companies   Company @relation(fields: [companyId], references: [id])
  users       User     @relation(fields: [userId], references: [id])

  @@index([companyId, createdAt])
  @@index([entityType, entityId])
  @@index([userId, createdAt])
}

model Category {
  id               String       @id @default(cuid())
  name             String
  code             String
  description      String?
  parentId         String?
  isActive         Boolean      @default(true)
  createdAt        DateTime     @default(now())
  updatedAt        DateTime @updatedAt
  companyId        String
  assets           Asset[]
  companies        Company    @relation(fields: [companyId], references: [id])
  categories       Category?  @relation("categoriesTocategories", fields: [parentId], references: [id])
  other_categories Category[] @relation("categoriesTocategories")

  @@unique([companyId, code])

  @@map("categories")
}

model Company {
  id                      String                    @id @default(cuid())
  name                    String                    @unique
  code                    String                    @unique
  address                 String?
  phone                   String?
  email                   String?
  website                 String?
  logo                    String?
  taxNumber               String?
  registrationNumber      String?
  description             String?
  isActive                Boolean                   @default(true)
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime @updatedAt
  asset_attachments       asset_attachments[]
  asset_requests          AssetRequest[]
  asset_required_software asset_required_software[]
  assets                  Asset[]
  audit_trails            audit_trails[]
  categories              Category[]
  departments             Department[]
  employees               Employee[]
  locations               Location[]
  maintenance_records     MaintenanceRecord[]
  notifications           notifications[]
  roles                   roles[]
  software_assets         SoftwareAsset[]
  software_installations  software_installations[]
  software_licenses       SoftwareLicense[]
  spare_parts             SparePart[]
  users                   User[]
  vendors                 Vendor[]

  @@map("companies")
}

model component_maintenance_records {
  id               String           @id @default(cuid())
  description      String
  maintenanceType  String
  maintenanceDate  DateTime         @default(now())
  cost             Decimal?         @db.Decimal(10, 2)
  notes            String?
  componentId      String
  performedById    String
  createdAt        DateTime         @default(now())
  updatedAt        DateTime @updatedAt
  asset_components asset_components @relation(fields: [componentId], references: [id])
  users            User            @relation(fields: [performedById], references: [id])
}

model component_transfers {
  id                                             String           @id @default(cuid())
  transferNumber                                 String           @unique
  reason                                         String
  transferDate                                   DateTime         @default(now())
  notes                                          String?
  componentId                                    String
  fromAssetId                                    String
  toAssetId                                      String
  transferredById                                String
  createdAt                                      DateTime         @default(now())
  updatedAt                                      DateTime @updatedAt
  asset_components                               asset_components @relation(fields: [componentId], references: [id])
  assets_component_transfers_fromAssetIdToassets Asset           @relation("component_transfers_fromAssetIdToassets", fields: [fromAssetId], references: [id])
  assets_component_transfers_toAssetIdToassets   Asset           @relation("component_transfers_toAssetIdToassets", fields: [toAssetId], references: [id])
  users                                          User            @relation(fields: [transferredById], references: [id])
}

model Department {
  id                                                            String            @id @default(cuid())
  name                                                          String
  code                                                          String
  description                                                   String?
  managerId                                                     String?
  budgetLimit                                                   Decimal?          @db.Decimal(15, 2)
  isActive                                                      Boolean           @default(true)
  createdAt                                                     DateTime          @default(now())
  updatedAt                                                     DateTime @updatedAt
  companyId                                                     String
  costCenter                                                    String?
  parentDepartmentId                                            String?
  asset_requests                                                AssetRequest[]
  asset_transfers_asset_transfers_fromDepartmentIdTodepartments asset_transfers[] @relation("asset_transfers_fromDepartmentIdTodepartments")
  asset_transfers_asset_transfers_toDepartmentIdTodepartments   asset_transfers[] @relation("asset_transfers_toDepartmentIdTodepartments")
  assets                                                        Asset[]
  companies                                                     Company         @relation(fields: [companyId], references: [id])
  users_departments_managerIdTousers                            User?            @relation("departments_managerIdTousers", fields: [managerId], references: [id])
  departments                                                   Department?      @relation("departmentsTodepartments", fields: [parentDepartmentId], references: [id])
  other_departments                                             Department[]     @relation("departmentsTodepartments")
  employees                                                     Employee[]
  inventories                                                   inventories[]
  users_users_departmentIdTodepartments                         User[]           @relation("users_departmentIdTodepartments")

  @@unique([companyId, code])

  @@map("departments")
}

model depreciation_records {
  id                  String              @id @default(cuid())
  period              String
  depreciationAmount  Decimal             @db.Decimal(15, 2)
  bookValueBefore     Decimal             @db.Decimal(15, 2)
  bookValueAfter      Decimal             @db.Decimal(15, 2)
  calculationDate     DateTime            @default(now())
  notes               String?
  depreciationId      String
  createdAt           DateTime            @default(now())
  updatedAt           DateTime @updatedAt
  asset_depreciations asset_depreciations @relation(fields: [depreciationId], references: [id])
}

model disposal_records {
  id                String   @id @default(cuid())
  disposalType      String
  disposalDate      DateTime
  disposalValue     Decimal? @db.Decimal(15, 2)
  reason            String
  approvalReference String?
  notes             String?
  assetId           String   @unique
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  assets            Asset   @relation(fields: [assetId], references: [id])
}

model Employee {
  id                                                               String            @id @default(cuid())
  npk                                                              String            @unique
  firstName                                                        String
  lastName                                                         String
  email                                                            String?
  phone                                                            String?
  dateOfBirth                                                      DateTime?
  hireDate                                                         DateTime?
  terminationDate                                                  DateTime?
  address                                                          String?
  position                                                         String?
  isActive                                                         Boolean           @default(true)
  createdAt                                                        DateTime          @default(now())
  updatedAt                                                        DateTime @updatedAt
  companyId                                                        String
  departmentId                                                     String?
  locationId                                                       String?
  userId                                                           String?           @unique
  asset_transfers_asset_transfers_fromEmployeeIdToemployees        asset_transfers[] @relation("asset_transfers_fromEmployeeIdToemployees")
  asset_transfers_asset_transfers_toEmployeeIdToemployees          asset_transfers[] @relation("asset_transfers_toEmployeeIdToemployees")
  assets                                                           Asset[]
  companies                                                        Company         @relation(fields: [companyId], references: [id])
  departments                                                      Department?      @relation(fields: [departmentId], references: [id])
  locations                                                        Location?        @relation(fields: [locationId], references: [id])
  users                                                            User?            @relation(fields: [userId], references: [id])
  inventory_loans_inventory_loans_borrowerEmployeeIdToemployees    InventoryLoan[] @relation("inventory_loans_borrowerEmployeeIdToemployees")
  inventory_loans_inventory_loans_responsibleEmployeeIdToemployees InventoryLoan[] @relation("inventory_loans_responsibleEmployeeIdToemployees")

  @@unique([companyId, npk])
  @@index([companyId])
  @@index([departmentId])
  @@index([locationId])

  @@map("employees")
}

model GlobalTypeMaster {
  id          String   @id @default(cuid())
  group       String
  key         String
  label       String
  description String?
  sortOrder   Int      @default(0)
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([group, key])
  @@index([group, isActive])

  @@map("global_type_master")
}

model inventories {
  id              String            @id @default(cuid())
  inventoryTag    String            @unique
  quantity        Int               @default(1)
  availableQty    Int               @default(1)
  condition       String            @default("GOOD")
  status          String            @default("AVAILABLE")
  location        String?
  notes           String?
  minStockLevel   Int?              @default(1)
  assetId         String
  departmentId    String
  custodianId     String?
  createdAt       DateTime          @default(now())
  updatedAt       DateTime @updatedAt
  companyId       String
  assets          Asset            @relation(fields: [assetId], references: [id])
  users           User?            @relation(fields: [custodianId], references: [id])
  departments     Department       @relation(fields: [departmentId], references: [id])
  inventory_loans InventoryLoan[]

  @@unique([assetId, departmentId])
  @@index([companyId, departmentId, status])
  @@index([companyId, status])
}

model InventoryLoan {
  id                                                         String      @id @default(cuid())
  loanNumber                                                 String      @unique
  purpose                                                    String
  quantity                                                   Int         @default(1)
  loanDate                                                   DateTime    @default(now())
  expectedReturnDate                                         DateTime
  actualReturnDate                                           DateTime?
  status                                                     String      @default("ACTIVE")
  condition                                                  String?
  notes                                                      String?
  approvalNotes                                              String?
  inventoryId                                                String
  approvedById                                               String?
  createdAt                                                  DateTime    @default(now())
  updatedAt                                                  DateTime @updatedAt
  borrowerEmployeeId                                         String
  requestedById                                              String
  responsibleEmployeeId                                      String
  approvedBy                                                 User?      @relation("inventory_loans_approvedByIdTousers", fields: [approvedById], references: [id])
  borrowerEmployee                                           Employee   @relation("inventory_loans_borrowerEmployeeIdToemployees", fields: [borrowerEmployeeId], references: [id])
  inventory                                                  inventories @relation(fields: [inventoryId], references: [id])
  requestedBy                                                User       @relation("inventory_loans_requestedByIdTousers", fields: [requestedById], references: [id])
  responsibleEmployee                                        Employee   @relation("inventory_loans_responsibleEmployeeIdToemployees", fields: [responsibleEmployeeId], references: [id])

  @@map("inventory_loans")
}

model license_renewals {
  id                String            @id @default(cuid())
  renewalDate       DateTime
  newExpiryDate     DateTime
  cost              Decimal           @db.Decimal(15, 2)
  notes             String?
  licenseId         String
  createdAt         DateTime          @default(now())
  updatedAt         DateTime @updatedAt
  software_licenses SoftwareLicense @relation(fields: [licenseId], references: [id])
}

model Location {
  id                                                        String            @id @default(cuid())
  name                                                      String
  building                                                  String?
  floor                                                     String?
  room                                                      String?
  address                                                   String?
  description                                               String?
  isActive                                                  Boolean           @default(true)
  createdAt                                                 DateTime          @default(now())
  updatedAt                                                 DateTime @updatedAt
  capacity                                                  Int?
  city                                                      String?
  code                                                      String?
  companyId                                                 String
  country                                                   String?
  managerId                                                 String?
  postalCode                                                String?
  state                                                     String?
  type                                                      String?
  asset_transfers_asset_transfers_fromLocationIdTolocations asset_transfers[] @relation("asset_transfers_fromLocationIdTolocations")
  asset_transfers_asset_transfers_toLocationIdTolocations   asset_transfers[] @relation("asset_transfers_toLocationIdTolocations")
  assets                                                    Asset[]
  employees                                                 Employee[]
  companies                                                 Company         @relation(fields: [companyId], references: [id])
  users_locations_managerIdTousers                          User?            @relation("locations_managerIdTousers", fields: [managerId], references: [id])
  users_users_locationIdTolocations                         User[]           @relation("users_locationIdTolocations")

  @@unique([companyId, code])
  @@unique([companyId, name])

  @@map("locations")
}

model maintenance_attachments {
  id                  String              @id @default(cuid())
  filename            String
  originalName        String
  mimeType            String
  fileSize            Int
  filePath            String
  description         String?
  attachmentType      String              @default("GENERAL")
  maintenanceId       String
  uploadedById        String
  createdAt           DateTime            @default(now())
  updatedAt           DateTime @updatedAt
  maintenance_records MaintenanceRecord @relation(fields: [maintenanceId], references: [id])
  users               User               @relation(fields: [uploadedById], references: [id])
}

model maintenance_contracts {
  id             String   @id @default(cuid())
  contractNumber String   @unique
  description    String
  startDate      DateTime
  endDate        DateTime
  cost           Decimal  @db.Decimal(15, 2)
  terms          String?
  isActive       Boolean  @default(true)
  vendorId       String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  vendors        Vendor  @relation(fields: [vendorId], references: [id])
}

model MaintenanceRecord {
  id                                            String                    @id @default(cuid())
  description                                   String
  scheduledDate                                 DateTime
  completedDate                                 DateTime?
  status                                        String
  notes                                         String?
  assetId                                       String
  technicianId                                  String?
  vendorId                                      String?
  createdAt                                     DateTime                  @default(now())
  updatedAt                                     DateTime @updatedAt
  actualCost                                    Decimal?                  @db.Decimal(15, 2)
  companyId                                     String
  downtime                                      Int?
  estimatedCost                                 Decimal?                  @db.Decimal(15, 2)
  maintenanceNumber                             String                    @unique
  priority                                      String                    @default("MEDIUM")
  requestId                                     String?
  startedDate                                   DateTime?
  supervisorId                                  String?
  title                                         String
  workDescription                               String?
  maintenanceType                               String
  editedBy                                      String?
  lastEditedAt                                  DateTime?
  maintenance_attachments                       maintenance_attachments[]
  assets                                        Asset                    @relation(fields: [assetId], references: [id])
  companies                                     Company                 @relation(fields: [companyId], references: [id])
  users_maintenance_records_editedByTousers     User?                    @relation("maintenance_records_editedByTousers", fields: [editedBy], references: [id])
  asset_requests                                AssetRequest?           @relation(fields: [requestId], references: [id])
  users_maintenance_records_supervisorIdTousers User?                    @relation("maintenance_records_supervisorIdTousers", fields: [supervisorId], references: [id])
  users_maintenance_records_technicianIdTousers User?                    @relation("maintenance_records_technicianIdTousers", fields: [technicianId], references: [id])
  vendors                                       Vendor?                  @relation(fields: [vendorId], references: [id])
  part_usages                                   part_usages[]

  @@map("maintenance_records")
}

model new_part_registrations {
  id                 String      @id @default(cuid())
  registrationNumber String      @unique
  serialNumber       String?
  assetTag           String?
  status             String
  registeredDate     DateTime?
  notes              String?
  partId             String
  assetId            String?
  registeredById     String
  createdAt          DateTime    @default(now())
  updatedAt          DateTime @updatedAt
  assets             Asset?     @relation(fields: [assetId], references: [id])
  spare_parts        SparePart @relation(fields: [partId], references: [id])
  users              User       @relation(fields: [registeredById], references: [id])
}

model notifications {
  id                String    @id @default(cuid())
  title             String
  message           String
  type              String
  isRead            Boolean   @default(false)
  userId            String
  createdAt         DateTime  @default(now())
  updatedAt         DateTime @updatedAt
  actionLabel       String?
  actionUrl         String?
  companyId         String
  expiresAt         DateTime?
  metadata          Json?
  priority          String    @default("MEDIUM")
  relatedEntityId   String?
  relatedEntityType String?
  companies         Company @relation(fields: [companyId], references: [id])
  users             User     @relation(fields: [userId], references: [id])

  @@index([companyId, type, createdAt])
  @@index([userId, isRead, createdAt])
}

model part_replacements {
  id                                                   String            @id @default(cuid())
  replacementNumber                                    String            @unique
  reason                                               String
  status                                               String
  plannedDate                                          DateTime?
  completedDate                                        DateTime?
  cost                                                 Decimal?          @db.Decimal(10, 2)
  notes                                                String?
  oldPartId                                            String?
  oldComponentId                                       String?
  newPartId                                            String
  assetId                                              String
  performedById                                        String?
  createdAt                                            DateTime          @default(now())
  updatedAt                                            DateTime @updatedAt
  assets                                               Asset            @relation(fields: [assetId], references: [id])
  spare_parts_part_replacements_newPartIdTospare_parts SparePart       @relation("part_replacements_newPartIdTospare_parts", fields: [newPartId], references: [id])
  asset_components                                     asset_components? @relation(fields: [oldComponentId], references: [id])
  spare_parts_part_replacements_oldPartIdTospare_parts SparePart?      @relation("part_replacements_oldPartIdTospare_parts", fields: [oldPartId], references: [id])
  users                                                User?            @relation(fields: [performedById], references: [id])
}

model part_usages {
  id                  String               @id @default(cuid())
  quantity            Int
  usageType           String
  usageDate           DateTime             @default(now())
  notes               String?
  partId              String
  assetId             String?
  componentId         String?
  maintenanceId       String?
  usedById            String
  createdAt           DateTime             @default(now())
  updatedAt           DateTime @updatedAt
  assets              Asset?              @relation(fields: [assetId], references: [id])
  asset_components    asset_components?    @relation(fields: [componentId], references: [id])
  maintenance_records MaintenanceRecord? @relation(fields: [maintenanceId], references: [id])
  spare_parts         SparePart          @relation(fields: [partId], references: [id])
  users               User                @relation(fields: [usedById], references: [id])
}

model procurements {
  id                String      @id @default(cuid())
  procurementNumber String      @unique
  quantity          Int
  unitPrice         Decimal     @db.Decimal(10, 2)
  totalCost         Decimal     @db.Decimal(12, 2)
  status            String
  orderedDate       DateTime    @default(now())
  expectedDate      DateTime?
  receivedDate      DateTime?
  receivedQuantity  Int?
  invoiceNumber     String?
  notes             String?
  partId            String
  vendorId          String?
  orderedById       String
  createdAt         DateTime    @default(now())
  updatedAt         DateTime @updatedAt
  users             User       @relation(fields: [orderedById], references: [id])
  spare_parts       SparePart @relation(fields: [partId], references: [id])
  vendors           Vendor?    @relation(fields: [vendorId], references: [id])
}

model request_attachments {
  id             String         @id @default(cuid())
  filename       String
  originalName   String
  mimeType       String
  fileSize       Int
  filePath       String
  description    String?
  requestId      String
  uploadedById   String
  createdAt      DateTime       @default(now())
  updatedAt      DateTime @updatedAt
  asset_requests AssetRequest @relation(fields: [requestId], references: [id])
  users          User          @relation(fields: [uploadedById], references: [id])
}

model request_workflows {
  id             String         @id @default(cuid())
  step           String
  stepOrder      Int
  status         String         @default("PENDING")
  comments       String?
  processedDate  DateTime?
  requestId      String
  processedById  String?
  createdAt      DateTime       @default(now())
  updatedAt      DateTime @updatedAt
  users          User?         @relation(fields: [processedById], references: [id])
  asset_requests AssetRequest @relation(fields: [requestId], references: [id])
}

model roles {
  id           String     @id @default(cuid())
  name         String
  code         String
  description  String?
  permissions  String[]
  isSystemRole Boolean    @default(false)
  isActive     Boolean    @default(true)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime @updatedAt
  companyId    String?
  companies    Company? @relation(fields: [companyId], references: [id])

  @@unique([code, companyId])
}

model SoftwareAsset {
  id                      String                    @id @default(cuid())
  name                    String
  version                 String?
  publisher               String?
  description             String?
  softwareType            String
  category                String?
  systemRequirements      Json?
  installationPath        String?
  isActive                Boolean                   @default(true)
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime @updatedAt
  companyId               String
  dir_attachments         String?
  editedBy                String?
  lastEditedAt            DateTime?
  asset_required_software asset_required_software[]
  companies               Company                 @relation(fields: [companyId], references: [id])
  users                   User?                    @relation(fields: [editedBy], references: [id])
  software_installations  software_installations[]
  software_licenses       SoftwareLicense[]

  @@map("software_assets")
}

model software_attachments {
  id              String   @id @default(cuid())
  fileName        String
  originalName    String
  filePath        String
  fileSize        Int?
  mimeType        String?
  attachmentType  String
  description     String?
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  softwareAssetId String
  companyId       String
  uploadedById    String
}

model software_installations {
  id                 String             @id @default(cuid())
  installationDate   DateTime           @default(now())
  uninstallationDate DateTime?
  status             String             @default("INSTALLED")
  installationPath   String?
  version            String?
  notes              String?
  softwareAssetId    String
  licenseId          String?
  assetId            String?
  userId             String?
  companyId          String
  createdAt          DateTime           @default(now())
  updatedAt          DateTime @updatedAt
  assets             Asset?            @relation(fields: [assetId], references: [id])
  companies          Company          @relation(fields: [companyId], references: [id])
  software_licenses  SoftwareLicense? @relation(fields: [licenseId], references: [id])
  software_assets    SoftwareAsset    @relation(fields: [softwareAssetId], references: [id])
  users              User?             @relation(fields: [userId], references: [id])
}

model SoftwareLicense {
  id                     String                   @id @default(cuid())
  licenseKey             String?
  licenseType            String
  status                 String
  totalSeats             Int                      @default(1)
  usedSeats              Int                      @default(0)
  availableSeats         Int                      @default(1)
  purchaseDate           DateTime?
  expiryDate             DateTime?
  renewalDate            DateTime?
  purchaseCost           Decimal?                 @db.Decimal(15, 2)
  renewalCost            Decimal?                 @db.Decimal(15, 2)
  notes                  String?
  isActive               Boolean                  @default(true)
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime @updatedAt
  softwareAssetId        String
  vendorId               String?
  companyId              String
  license_renewals       license_renewals[]
  software_installations software_installations[]
  company                Company                @relation(fields: [companyId], references: [id])
  softwareAsset          SoftwareAsset          @relation(fields: [softwareAssetId], references: [id])
  vendor                 Vendor?                @relation(fields: [vendorId], references: [id])

  @@map("software_licenses")
}

model SparePart {
  id                                                         String                   @id @default(cuid())
  partNumber                                                 String
  name                                                       String
  description                                                String?
  brand                                                      String?
  model                                                      String?
  category                                                   String
  partType                                                   String
  status                                                     String
  unitPrice                                                  Decimal                  @db.Decimal(10, 2)
  stockLevel                                                 Int                      @default(0)
  minStockLevel                                              Int                      @default(10)
  maxStockLevel                                              Int                      @default(100)
  reorderPoint                                               Int                      @default(15)
  storageLocation                                            String?
  specifications                                             Json?
  compatibleWith                                             String[]
  notes                                                      String?
  isActive                                                   Boolean                  @default(true)
  vendorId                                                   String?
  createdAt                                                  DateTime                 @default(now())
  updatedAt                                                  DateTime @updatedAt
  companyId                                                  String
  createdFromRequestId                                       String?
  sourceAssetId                                              String?
  editedBy                                                   String?
  lastEditedAt                                               DateTime?
  asset_components                                           asset_components[]
  new_part_registrations                                     new_part_registrations[]
  part_replacements_part_replacements_newPartIdTospare_parts part_replacements[]      @relation("part_replacements_newPartIdTospare_parts")
  part_replacements_part_replacements_oldPartIdTospare_parts part_replacements[]      @relation("part_replacements_oldPartIdTospare_parts")
  part_usages                                                part_usages[]
  procurements                                               procurements[]
  companies                                                  Company                @relation(fields: [companyId], references: [id])
  users                                                      User?                   @relation(fields: [editedBy], references: [id])
  vendors                                                    Vendor?                 @relation(fields: [vendorId], references: [id])

  @@unique([companyId, partNumber])
  @@index([companyId, category])
  @@index([createdFromRequestId])
  @@index([sourceAssetId])

  @@map("spare_parts")
}

model SystemSettings {
  id          String   @id @default(cuid())
  key         String   @unique
  value       String
  description String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("system_settings")
}

model User {
  id                                                          String                          @id @default(cuid())
  email                                                       String                          @unique
  username                                                    String                          @unique
  password                                                    String
  firstName                                                   String
  lastName                                                    String
  phone                                                       String?
  role                                                        String
  isActive                                                    Boolean                         @default(true)
  createdAt                                                   DateTime                        @default(now())
  updatedAt                                                   DateTime @updatedAt
  departmentId                                                String?
  address                                                     String?
  companyId                                                   String
  dateOfBirth                                                 DateTime?
  emergencyContact                                            String?
  emergencyPhone                                              String?
  employeeNumber                                              String                          @unique
  hireDate                                                    DateTime?
  managerId                                                   String?
  terminationDate                                             DateTime?
  locationId                                                  String?
  asset_attachments                                           asset_attachments[]
  asset_requests_asset_requests_approvedByIdTousers           AssetRequest[]                @relation("asset_requests_approvedByIdTousers")
  asset_requests_asset_requests_editedByTousers               AssetRequest[]                @relation("asset_requests_editedByTousers")
  asset_requests_asset_requests_requesterIdTousers            AssetRequest[]                @relation("asset_requests_requesterIdTousers")
  asset_transfers_asset_transfers_approvedByIdTousers         asset_transfers[]               @relation("asset_transfers_approvedByIdTousers")
  asset_transfers_asset_transfers_editedByTousers             asset_transfers[]               @relation("asset_transfers_editedByTousers")
  asset_transfers_asset_transfers_requestedByIdTousers        asset_transfers[]               @relation("asset_transfers_requestedByIdTousers")
  assets                                                      Asset[]
  audit_records_audit_records_auditorIdTousers                audit_records[]                 @relation("audit_records_auditorIdTousers")
  audit_records_audit_records_editedByTousers                 audit_records[]                 @relation("audit_records_editedByTousers")
  audit_trails                                                audit_trails[]
  component_maintenance_records                               component_maintenance_records[]
  component_transfers                                         component_transfers[]
  departments_departments_managerIdTousers                    Department[]                   @relation("departments_managerIdTousers")
  employees                                                   Employee?
  inventories                                                 inventories[]
  inventory_loans_inventory_loans_approvedByIdTousers         InventoryLoan[]               @relation("inventory_loans_approvedByIdTousers")
  inventory_loans_inventory_loans_requestedByIdTousers        InventoryLoan[]               @relation("inventory_loans_requestedByIdTousers")
  locations_locations_managerIdTousers                        Location[]                     @relation("locations_managerIdTousers")
  maintenance_attachments                                     maintenance_attachments[]
  maintenance_records_maintenance_records_editedByTousers     MaintenanceRecord[]           @relation("maintenance_records_editedByTousers")
  maintenance_records_maintenance_records_supervisorIdTousers MaintenanceRecord[]           @relation("maintenance_records_supervisorIdTousers")
  maintenance_records_maintenance_records_technicianIdTousers MaintenanceRecord[]           @relation("maintenance_records_technicianIdTousers")
  new_part_registrations                                      new_part_registrations[]
  notifications                                               notifications[]
  part_replacements                                           part_replacements[]
  part_usages                                                 part_usages[]
  procurements                                                procurements[]
  request_attachments                                         request_attachments[]
  request_workflows                                           request_workflows[]
  software_assets                                             SoftwareAsset[]
  software_installations                                      software_installations[]
  spare_parts                                                 SparePart[]
  company                                                     Company                       @relation(fields: [companyId], references: [id])
  department                                                  Department?                   @relation("users_departmentIdTodepartments", fields: [departmentId], references: [id])
  location                                                    Location?                     @relation("users_locationIdTolocations", fields: [locationId], references: [id])
  manager                                                     User?                         @relation("usersTousers", fields: [managerId], references: [id])
  managedUsers                                                User[]                        @relation("usersTousers")

  @@map("users")
}

model Vendor {
  id                    String                  @id @default(cuid())
  name                  String
  code                  String
  email                 String?
  phone                 String?
  address               String?
  contactPerson         String?
  isActive              Boolean                 @default(true)
  createdAt             DateTime                @default(now())
  updatedAt             DateTime @updatedAt
  companyId             String
  assets                Asset[]
  maintenance_contracts maintenance_contracts[]
  maintenance_records   MaintenanceRecord[]
  procurements          procurements[]
  software_licenses     SoftwareLicense[]
  spare_parts           SparePart[]
  companies             Company               @relation(fields: [companyId], references: [id])

  @@unique([companyId, code])

  @@map("vendors")
}
